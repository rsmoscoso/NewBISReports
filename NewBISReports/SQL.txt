select distinct Nome = isnull(firstname, '') + ' ' + isnull(lastname, ''), TipoPessoa = classes.DISPLAYTEXTCUSTOMER,  Documento = case when persclass = 'E' then per.persno else vis.passportno end,  UltimoAcesso = convert(varchar, accesstime, 103) + ' ' + convert(varchar, accesstime, 108),  Situacao = case when per.status = 1 then 'Ativo' else 'Inativo' end, Matricula = idnumber, cli.NAME as CLIENTE,convert(date,DATEOFBIRTH, 103) as NASCIMENTO,per.STREETHOUSENO as ENDERECO,per.CITY as CIDADE,PHONEPRIVATE as TELEFONE,DEPARTMATTEND as LOCALIZAÇÃO,COSTCENTRE as CENTROCUSTO,JOB as CARGO,COMPANYNO as EMPRESA,CARDNO as NCARTAO,convert(int, convert(varbinary(4),CODEDATA)) as SITECODE from bsuser.persons per left outer join bsuser.companies cmp on per.companyid = cmp.companyid  inner join bsuser.PERSCLASSES classes on classes.PERSCLASSID = per.PERSCLASSID  left outer join bsuser.visitors vis on vis.persid = per.persid  left outer join bsuser.cards cd on per.persid = cd.persid inner join bsuser.clients cli on cli.clientid = per.clientid  left outer join bsuser.currentaccessstate cursta on cursta.persid = per.persid  where per.status in (0, 1)  and per.persclassid in ('FF0000E500000001') order by Nome
Data Source=10.62.150.166\BIS_ACE; UID=solarsql; Password=solarsql; Database=acedb;Connection Timeout=0; MultipleActiveResultSets='true'
select distinct Nome = isnull(firstname, '') + ' ' + isnull(lastname, ''), TipoPessoa = classes.DISPLAYTEXTCUSTOMER,  Documento = case when persclass = 'E' then per.persno else vis.passportno end,  UltimoAcesso = convert(varchar, accesstime, 103) + ' ' + convert(varchar, accesstime, 108),  Situacao = case when per.status = 1 then 'Ativo' else 'Inativo' end, Matricula = idnumber, cli.NAME as CLIENTE,convert(date,DATEOFBIRTH, 103) as NASCIMENTO,per.STREETHOUSENO as ENDERECO,per.CITY as CIDADE,PHONEPRIVATE as TELEFONE,DEPARTMATTEND as LOCALIZAÇÃO,COSTCENTRE as CENTROCUSTO,JOB as CARGO,COMPANYNO as EMPRESA,CARDNO as NCARTAO,convert(int, convert(varbinary(4),CODEDATA)) as SITECODE from bsuser.persons per left outer join bsuser.companies cmp on per.companyid = cmp.companyid  inner join bsuser.PERSCLASSES classes on classes.PERSCLASSID = per.PERSCLASSID  left outer join bsuser.visitors vis on vis.persid = per.persid  left outer join bsuser.cards cd on per.persid = cd.persid inner join bsuser.clients cli on cli.clientid = per.clientid  left outer join bsuser.currentaccessstate cursta on cursta.persid = per.persid  where per.status in (0, 1)  order by Nome
Data Source=10.62.150.166\BIS_ACE; UID=solarsql; Password=solarsql; Database=acedb;Connection Timeout=0; MultipleActiveResultSets='true'
select distinct Nome = isnull(firstname, '') + ' ' + isnull(lastname, ''), TipoPessoa = classes.DISPLAYTEXTCUSTOMER,  Documento = case when persclass = 'E' then per.persno else vis.passportno end,  UltimoAcesso = convert(varchar, accesstime, 103) + ' ' + convert(varchar, accesstime, 108),  Situacao = case when per.status = 1 then 'Ativo' else 'Inativo' end, Matricula = idnumber, cli.NAME as CLIENTE,convert(date,DATEOFBIRTH, 103) as NASCIMENTO,per.STREETHOUSENO as ENDERECO,per.CITY as CIDADE,PHONEPRIVATE as TELEFONE,DEPARTMATTEND as LOCALIZAÇÃO,COSTCENTRE as CENTROCUSTO,JOB as CARGO,COMPANYNO as EMPRESA,CARDNO as NCARTAO,convert(int, convert(varbinary(4),CODEDATA)) as SITECODE from bsuser.persons per left outer join bsuser.companies cmp on per.companyid = cmp.companyid  inner join bsuser.PERSCLASSES classes on classes.PERSCLASSID = per.PERSCLASSID  left outer join bsuser.visitors vis on vis.persid = per.persid  left outer join bsuser.cards cd on per.persid = cd.persid inner join bsuser.clients cli on cli.clientid = per.clientid  left outer join bsuser.currentaccessstate cursta on cursta.persid = per.persid  where per.status in (0, 1) and cd.status = 1  and per.persid = '001301D4C6E0EB79' order by Nome
Data Source=10.62.150.166\BIS_ACE; UID=solarsql; Password=solarsql; Database=acedb;Connection Timeout=0; MultipleActiveResultSets='true'
select distinct Nome = isnull(firstname, '') + ' ' + isnull(lastname, ''), TipoPessoa = classes.DISPLAYTEXTCUSTOMER,  Documento = case when persclass = 'E' then per.persno else vis.passportno end,  UltimoAcesso = convert(varchar, accesstime, 103) + ' ' + convert(varchar, accesstime, 108),  Situacao = case when per.status = 1 then 'Ativo' else 'Inativo' end, cli.NAME as CLIENTE,convert(date,DATEOFBIRTH, 103) as NASCIMENTO,per.STREETHOUSENO as ENDERECO,per.CITY as CIDADE,PHONEPRIVATE as TELEFONE,DEPARTMATTEND as LOCALIZAÇÃO,COSTCENTRE as CENTROCUSTO,JOB as CARGO,COMPANYNO as EMPRESA,CARDNO as NCARTAO,convert(int, convert(varbinary(4),CODEDATA)) as SITECODE from bsuser.persons per left outer join bsuser.companies cmp on per.companyid = cmp.companyid  inner join bsuser.PERSCLASSES classes on classes.PERSCLASSID = per.PERSCLASSID  left outer join bsuser.visitors vis on vis.persid = per.persid  left outer join bsuser.cards cd on per.persid = cd.persid inner join bsuser.clients cli on cli.clientid = per.clientid  left outer join bsuser.currentaccessstate cursta on cursta.persid = per.persid  where per.status in (0, 1) and cd.status = 1  order by Nome
Data Source=172.16.0.86\BIS_ACE; UID=sa; Password=S$iG3L9a@n; Database=acedb;Connection Timeout=0; MultipleActiveResultSets='true'
select distinct Nome = isnull(firstname, '') + ' ' + isnull(lastname, ''), TipoPessoa = classes.DISPLAYTEXTCUSTOMER,  Documento = case when persclass = 'E' then per.persno else vis.passportno end,  UltimoAcesso = convert(varchar, accesstime, 103) + ' ' + convert(varchar, accesstime, 108),  Situacao = case when per.status = 1 then 'Ativo' else 'Inativo' end, cli.NAME as CLIENTE,convert(date,DATEOFBIRTH, 103) as NASCIMENTO,per.STREETHOUSENO as ENDERECO,per.CITY as CIDADE,PHONEPRIVATE as TELEFONE,DEPARTMATTEND as LOCALIZAÇÃO,COSTCENTRE as CENTROCUSTO,JOB as CARGO,COMPANYNO as EMPRESA,CARDNO as NCARTAO,convert(int, convert(varbinary(4),CODEDATA)) as SITECODE from bsuser.persons per left outer join bsuser.companies cmp on per.companyid = cmp.companyid  inner join bsuser.PERSCLASSES classes on classes.PERSCLASSID = per.PERSCLASSID  left outer join bsuser.visitors vis on vis.persid = per.persid  left outer join bsuser.cards cd on per.persid = cd.persid inner join bsuser.clients cli on cli.clientid = per.clientid  left outer join bsuser.currentaccessstate cursta on cursta.persid = per.persid  where per.status in (0, 1) and cd.status = 1  order by Nome
Data Source=172.16.0.86\BIS_ACE; UID=sa; Password=S$iG3L9a@n; Database=acedb;Connection Timeout=0; MultipleActiveResultSets='true'
